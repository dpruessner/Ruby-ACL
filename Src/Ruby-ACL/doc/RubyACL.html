<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=CP852" http-equiv="Content-Type">

<title>class RubyACL - RDoc Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/Ruby-ACL.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-load">::load</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-i-add_membership_principal">#add_membership_principal</a>
    
    <li><a href="#method-i-add_membership_privilege">#add_membership_privilege</a>
    
    <li><a href="#method-i-change_of_res_ob_address">#change_of_res_ob_address</a>
    
    <li><a href="#method-i-change_of_res_ob_owner">#change_of_res_ob_owner</a>
    
    <li><a href="#method-i-change_res_ob_type">#change_res_ob_type</a>
    
    <li><a href="#method-i-check">#check</a>
    
    <li><a href="#method-i-create_ace">#create_ace</a>
    
    <li><a href="#method-i-create_group">#create_group</a>
    
    <li><a href="#method-i-create_principal">#create_principal</a>
    
    <li><a href="#method-i-create_privilege">#create_privilege</a>
    
    <li><a href="#method-i-create_resource_object">#create_resource_object</a>
    
    <li><a href="#method-i-del_membership_principal">#del_membership_principal</a>
    
    <li><a href="#method-i-del_membership_privilege">#del_membership_privilege</a>
    
    <li><a href="#method-i-delete_ace">#delete_ace</a>
    
    <li><a href="#method-i-delete_principal">#delete_principal</a>
    
    <li><a href="#method-i-delete_privilege">#delete_privilege</a>
    
    <li><a href="#method-i-delete_res_object">#delete_res_object</a>
    
    <li><a href="#method-i-delete_res_object_by_id">#delete_res_object_by_id</a>
    
    <li><a href="#method-i-rename">#rename</a>
    
    <li><a href="#method-i-rename_principal">#rename_principal</a>
    
    <li><a href="#method-i-rename_privilege">#rename_privilege</a>
    
    <li><a href="#method-i-save">#save</a>
    
    <li><a href="#method-i-show_permissions_for">#show_permissions_for</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./LICENSE.html">LICENSE</a>
  
    <li class="file"><a href="./README.html">README</a>
  
    <li class="file"><a href="./Rakefile.html">Rakefile</a>
  
    <li class="file"><a href="./nbproject/private/rake-d_txt.html">rake-d</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./ACL_Object.html">ACL_Object</a>
  
    <li><a href="./Ace.html">Ace</a>
  
    <li><a href="./AceRule.html">AceRule</a>
  
    <li><a href="./Group.html">Group</a>
  
    <li><a href="./Individual.html">Individual</a>
  
    <li><a href="./Principal.html">Principal</a>
  
    <li><a href="./Privilege.html">Privilege</a>
  
    <li><a href="./ResourceObject.html">ResourceObject</a>
  
    <li><a href="./RubyACL.html">RubyACL</a>
  
    <li><a href="./RubyACLException.html">RubyACLException</a>
  
    <li><a href="./TestRubyACL.html">TestRubyACL</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class RubyACL</h1>

  <div id="description" class="description">
    
<p><a href="RubyACL.html">RubyACL</a> is library that handles access
permisions. <a href="RubyACL.html">RubyACL</a> offers to create and modify
three ACL objects - three dimensions: <a
href="Principal.html">Principal</a>, <a
href="Privilege.html">Privilege</a>, Resource object. <a
href="Principal.html">Principal</a> is someone or something that want to
access. <a href="Privilege.html">Privilege</a> is level of access. (read,
write etc.). Resource object is what is principal accessing. <a
href="RubyACL.html">RubyACL</a> uses API interface to communicate with
database. This interface is described by class API_inteface. At the end of
the class you can see set of examples. Also good source of information are
testcases.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-col_path" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">col_path</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>collection path in db, where ACL will be stored.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-name" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">name</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>name of the ACL</p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load</span><span
            class="method-args">(connector, colpath = "/db/acl/", src_files_path, report)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It loads backuped acl data.</p>

<pre>* *Args*    :
  - +connector+ -&gt;  instance of connection manager with db. e.g. ExistAPI.new(&quot;http://localhost:8080/exist/xmlrpc&quot;, &quot;admin&quot;, &quot;admin&quot;)    
  - +colpath+ -&gt; path of collection in db. e.g. &quot;/db/acl/&quot;
  - +src_files_path+ -&gt; path of source files in local location.
  - +report+ -&gt; boolean - if true Ruby-ACL 
* *Returns* :
  -new instance of Ruby-ACL
* *Raises* :
  - +nothin+</pre>
          

          
          <div class="method-source-code" id="load-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 343</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">RubyACL</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">connector</span>, <span class="ruby-identifier">colpath</span> = <span class="ruby-string">&quot;/db/acl/&quot;</span>, <span class="ruby-identifier">src_files_path</span>, <span class="ruby-identifier">report</span>)
  <span class="ruby-comment">#TODO proverit</span>
  <span class="ruby-identifier">xmlfile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">src_files_path</span><span class="ruby-operator">+</span><span class="ruby-string">&quot;acl.xml&quot;</span>)
  <span class="ruby-identifier">startindex</span> = <span class="ruby-identifier">xmlfile</span>.<span class="ruby-identifier">index</span>(<span class="ruby-string">'&quot;'</span>, <span class="ruby-identifier">xmlfile</span>.<span class="ruby-identifier">index</span>(<span class="ruby-string">&quot;aclname=&quot;</span>))
  <span class="ruby-identifier">endindex</span> = <span class="ruby-identifier">xmlfile</span>.<span class="ruby-identifier">index</span>(<span class="ruby-string">'&quot;'</span>, <span class="ruby-identifier">startindex</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)
  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">xmlfile</span>[<span class="ruby-identifier">startindex</span><span class="ruby-operator">+</span><span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">endindex</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]
  <span class="ruby-identifier">newacl</span> = <span class="ruby-constant">RubyACL</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">connector</span>, <span class="ruby-identifier">colpath</span>, <span class="ruby-identifier">src_files_path</span>, <span class="ruby-identifier">report</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">newacl</span>
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- load-source -->
          
        </div>

        

        
      </div><!-- load-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(name, connector, colpath = "/db/acl/", src_files_path = "./src_files/", report = false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Creates new instance of Ruby-ACL. Ruby-ACL works if principals, privileges
and resource object. With Ruby-ACL you can manage permsion to person for
resource objects.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the ACL
  - +connector+ -&gt;  instance of connection manager with db. e.g. ExistAPI.new(&quot;http://localhost:8080/exist/xmlrpc&quot;, &quot;admin&quot;, &quot;admin&quot;)    
  - +colpath+ -&gt; path of collection in db. e.g. &quot;/db/acl/&quot;
  - +src_files_path+ -&gt; path of source files in local location.
  - +report+ -&gt; boolean - if true Ruby-ACL 
* *Returns* :
  - instance of RubyACL
* *Raises* :
  - +RubyACLException+ -&gt; Name is empty</pre>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">connector</span>, <span class="ruby-identifier">colpath</span> = <span class="ruby-string">&quot;/db/acl/&quot;</span>, <span class="ruby-identifier">src_files_path</span> = <span class="ruby-string">&quot;./src_files/&quot;</span>, <span class="ruby-identifier">report</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">RubyACLException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">__method__</span>, <span class="ruby-string">&quot;Name is empty&quot;</span>, <span class="ruby-value">0</span>), <span class="ruby-identifier">caller</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>
  <span class="ruby-ivar">@connector</span> = <span class="ruby-identifier">connector</span>
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">colpath</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;/&quot;</span>)
    <span class="ruby-identifier">colpath</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;/&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@col_path</span> = <span class="ruby-identifier">colpath</span>
  <span class="ruby-ivar">@src_files_path</span> = <span class="ruby-identifier">src_files_path</span>
  <span class="ruby-ivar">@report</span> = <span class="ruby-identifier">report</span>
  <span class="ruby-ivar">@prin</span> = <span class="ruby-constant">Principal</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@connector</span>, <span class="ruby-ivar">@col_path</span>, <span class="ruby-ivar">@report</span>)
  <span class="ruby-ivar">@indi</span> = <span class="ruby-constant">Individual</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@connector</span>, <span class="ruby-ivar">@col_path</span>, <span class="ruby-ivar">@report</span>)
  <span class="ruby-ivar">@group</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@connector</span>, <span class="ruby-ivar">@col_path</span>, <span class="ruby-ivar">@report</span>)
  <span class="ruby-ivar">@priv</span> = <span class="ruby-constant">Privilege</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@connector</span>, <span class="ruby-ivar">@col_path</span>, <span class="ruby-ivar">@report</span>)
  <span class="ruby-ivar">@res_obj</span> = <span class="ruby-constant">ResourceObject</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@connector</span>, <span class="ruby-ivar">@col_path</span>, <span class="ruby-ivar">@report</span>)
  <span class="ruby-ivar">@ace</span> = <span class="ruby-constant">Ace</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@connector</span>, <span class="ruby-ivar">@col_path</span>, <span class="ruby-ivar">@report</span>)
  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">create_acl_in_db</span>()
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">class</span>
  <span class="ruby-identifier">rename</span>(<span class="ruby-identifier">name</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-add_membership_principal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_membership_principal</span><span
            class="method-args">(name, groups, existance = false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It adds principal into group(s) as member.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the principal
  - +groups+ -&gt; array of groups, where principal will be member.
  - +existance+ -&gt;  boolean. If you know that principal exists set true for existance. 
* *Returns* :
  - string, name of the principal
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="add_membership_principal-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 673</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_membership_principal</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">groups</span>, <span class="ruby-identifier">existance</span> = <span class="ruby-keyword">false</span>) 
  <span class="ruby-ivar">@prin</span>.<span class="ruby-identifier">add_membership</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">groups</span>, <span class="ruby-identifier">existance</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add_membership_principal-source -->
          
        </div>

        

        
      </div><!-- add_membership_principal-method -->

    
      <div id="method-i-add_membership_privilege" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_membership_privilege</span><span
            class="method-args">(name, groups, existance = false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It adds privilege into privilege(s). So you can gather privileges into
tree.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the privilege
  - +groups+ -&gt; array of privileges, where privilege will be member.
  - +existance+ -&gt;  boolean. If you know that privielge exists set true for existance. 
* *Returns* :
  - string, name of the privilege
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="add_membership_privilege-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 690</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_membership_privilege</span> (<span class="ruby-identifier">name</span>, <span class="ruby-identifier">groups</span>, <span class="ruby-identifier">existance</span> = <span class="ruby-keyword">false</span>) 
  <span class="ruby-ivar">@priv</span>.<span class="ruby-identifier">add_membership</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">groups</span>, <span class="ruby-identifier">existance</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add_membership_privilege-source -->
          
        </div>

        

        
      </div><!-- add_membership_privilege-method -->

    
      <div id="method-i-change_of_res_ob_address" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_of_res_ob_address</span><span
            class="method-args">(type, address, new_address)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It changes resource object's address.  Address and type must be specified
to identify resource object.</p>

<pre>* *Args*    :
  - +type+ -&gt; type of resource object
  - +address+ -&gt;  address of resource object
  - +new_address+ -&gt; new address of resource object
* *Returns* :
  - string, original address
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="change_of_res_ob_address-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 610</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_of_res_ob_address</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">new_address</span>)
  <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">change_address</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">new_address</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- change_of_res_ob_address-source -->
          
        </div>

        

        
      </div><!-- change_of_res_ob_address-method -->

    
      <div id="method-i-change_of_res_ob_owner" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_of_res_ob_owner</span><span
            class="method-args">(type, address, new_owner)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It changes resource object's owner.  Address and type must be specified to
identify resource object.</p>

<pre>* *Args*    :
  - +type+ -&gt; type of resource object
  - +address+ -&gt;  address of resource object
  - +new_owner+ -&gt; new owner of resource object
* *Returns* :
  - string, original owner
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="change_of_res_ob_owner-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 628</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_of_res_ob_owner</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">new_owner</span>)
  <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">change_owner</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">new_owner</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- change_of_res_ob_owner-source -->
          
        </div>

        

        
      </div><!-- change_of_res_ob_owner-method -->

    
      <div id="method-i-change_res_ob_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_res_ob_type</span><span
            class="method-args">(type, address, new_type)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It changes resource object's type.  Address and type must be specified to
identify resource object.</p>

<pre>* *Args*    :
  - +type+ -&gt; type of resource object
  - +address+ -&gt;  address of resource object
  - +new_type+ -&gt; new_type of resource object
* *Returns* :
  - string, original type
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="change_res_ob_type-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 592</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_res_ob_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">new_type</span>)
  <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">change_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">new_type</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- change_res_ob_type-source -->
          
        </div>

        

        
      </div><!-- change_res_ob_type-method -->

    
      <div id="method-i-check" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check</span><span
            class="method-args">(prin_name, priv_name, res_ob_type, res_ob_adr)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Decides whether principal has privilege or not to resource object
identified  by access type and address. If the accessType of ace is allow -
returns true.  If accessType of ace is deny return false.</p>

<p>Priority of decision is as follows lower.  Lowest number has highest
priority:</p>
<ol><li>
<p>Owner</p>
</li><li>
<p>Explicit Deny</p>
</li><li>
<p>Explicit Allow</p>
</li><li>
<p>Inherited Deny</p>
</li><li>
<p>Inherited Allow</p>
</li><li>
<p>If not found then Deny</p>
</li></ol>

<pre>* *Args*    :
  - +prin_name+ -&gt; name of the principal
  - +priv_name+ -&gt; name of the privilege
  - +res_ob_type+ -&gt; type of the resource object
  - +res_ob_adr+ -&gt; address of the resource object
* *Returns* :
  -boolean - true - has privilege to resource object, false - has not
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="check-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 379</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">check</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>)
    <span class="ruby-identifier">res_ob_id</span> = <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">find_res_ob</span>(<span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>)
    <span class="ruby-comment">#creates the set of resOb (wanted resOb and all resOb from root to address, unsorted)</span>
    <span class="ruby-ivar">@res_obs</span> = <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">find_res_ob_parents</span>(<span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>) 
    <span class="ruby-comment">#adds resOb, which ends with /* + wanted resOb</span>
    <span class="ruby-ivar">@res_obs</span> = <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">res_obs_grand2children</span>(<span class="ruby-ivar">@res_obs</span>) <span class="ruby-operator">+</span> [<span class="ruby-identifier">res_ob_id</span>]  
    
    <span class="ruby-keyword">if</span>(<span class="ruby-identifier">is_owner?</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-ivar">@res_obs</span>))
      <span class="ruby-comment">#puts &quot;owner&quot;</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>   <span class="ruby-comment">#access allowed - owner can do everything</span>
    <span class="ruby-keyword">end</span>
    
    <span class="ruby-comment">#creates the set of principals {wanted principal and all groups wanted principal is member of}</span>
    <span class="ruby-identifier">prins</span> = <span class="ruby-ivar">@prin</span>.<span class="ruby-identifier">find_parents</span>(<span class="ruby-identifier">prin_name</span>) <span class="ruby-operator">+</span> [<span class="ruby-identifier">prin_name</span>]    
    <span class="ruby-ivar">@privs</span> = <span class="ruby-ivar">@priv</span>.<span class="ruby-identifier">find_parents</span>(<span class="ruby-identifier">priv_name</span>) <span class="ruby-operator">+</span> [<span class="ruby-identifier">priv_name</span>]   <span class="ruby-comment">#same for privilege</span>
    
    <span class="ruby-identifier">final_ace</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">for</span> <span class="ruby-identifier">prin</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">prins</span>
      <span class="ruby-comment">#ask for principal with privilege or higher privileges and and resob or higher resob. </span>
      <span class="ruby-identifier">query</span> = <span class="ruby-identifier">prepare_query</span>(<span class="ruby-identifier">prin</span>, <span class="ruby-ivar">@privs</span>, <span class="ruby-ivar">@res_obs</span>)   
      <span class="ruby-comment">#puts query</span>
      <span class="ruby-identifier">handle</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">execute_query</span>(<span class="ruby-identifier">query</span>)
      <span class="ruby-identifier">hits</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">get_hits</span>(<span class="ruby-identifier">handle</span>)
      <span class="ruby-comment">#puts &quot;hits #{hits}&quot;</span>
      <span class="ruby-keyword">if</span>(<span class="ruby-identifier">hits</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)   
        <span class="ruby-identifier">temp_id</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">retrieve</span>(<span class="ruby-identifier">handle</span>, <span class="ruby-value">0</span>)   <span class="ruby-comment">#retrieve id of first Ace</span>
        <span class="ruby-identifier">temp_ace</span> = <span class="ruby-constant">AceRule</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">temp_id</span>, <span class="ruby-ivar">@ace</span>, <span class="ruby-ivar">@connector</span>)
        <span class="ruby-keyword">if</span>(<span class="ruby-identifier">hits</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>)
          <span class="ruby-identifier">final_ace</span> = <span class="ruby-identifier">compare</span>(<span class="ruby-identifier">final_ace</span>, <span class="ruby-identifier">temp_ace</span>)
        <span class="ruby-keyword">else</span>    <span class="ruby-comment">#there are more rules</span>
          <span class="ruby-identifier">hits</span>.<span class="ruby-identifier">times</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">temp_id</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">retrieve</span>(<span class="ruby-identifier">handle</span>, <span class="ruby-identifier">i</span>)   <span class="ruby-comment">#retrieve id of next Ace</span>
            <span class="ruby-identifier">temp_ace</span>.<span class="ruby-identifier">reload!</span>(<span class="ruby-identifier">temp_id</span>)
            <span class="ruby-identifier">final_ace</span> = <span class="ruby-identifier">compare</span>(<span class="ruby-identifier">final_ace</span>, <span class="ruby-identifier">temp_ace</span>)
          }
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    
    <span class="ruby-keyword">if</span>(<span class="ruby-identifier">final_ace</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>)  <span class="ruby-comment">#Rule doesnt exist = access denied</span>
      <span class="ruby-comment">#puts &quot;nil&quot;</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Required rule 
(#{prin_name}, #{priv_name}, #{res_ob_type}, #{res_ob_adr}) does not exist. 
Access denied.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@report</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">decide</span>(<span class="ruby-identifier">final_ace</span>.<span class="ruby-identifier">acc_type</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
    <span class="ruby-comment">#puts e.backtrace.join(&quot;\n&quot;)</span>
    <span class="ruby-comment">#raise RubyACLException.new(self.class.name, __method__, &quot;Failed to check ACE&quot;, 3), caller</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- check-source -->
          
        </div>

        

        
      </div><!-- check-method -->

    
      <div id="method-i-create_ace" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_ace</span><span
            class="method-args">(prin_name, acc_type, priv_name, res_ob_type, res_ob_adr, grand2children = false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Creates ace in acl. If resource object doesn't exist it creates resource
object first.</p>

<p>Address: If is used:</p>

<pre>resource address /something/somethingelse and grand2children = true
then will be created access for somthingelse and its children</pre>

<p>If is used:</p>

<pre> only /something/somethingelse/*
then will be created access only to somethingelse's children

* *Args*    :
  - +prin_name+ -&gt; name of the principal
  - +acc_type+ -&gt; access type. True = grant, false = revoke
  - +priv_name+ -&gt; name of the privilege
  - +res_ob_type+ -&gt; type of the resource object
  - +res_ob_adr+ -&gt; address of the resource object
  - +grand2children+ -&gt; boolean. 
        True = grant to all children. 
        False = grant only to specified resource object
* *Returns* :
  - string, id of the created ace
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="create_ace-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 491</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_ace</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">acc_type</span>, <span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>, <span class="ruby-identifier">grand2children</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">res_ob_adr</span>[<span class="ruby-value">-2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;/*&quot;</span>)
    <span class="ruby-identifier">id</span> = <span class="ruby-identifier">insert_ace</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">acc_type</span>, <span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">id</span> = <span class="ruby-identifier">insert_ace</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">acc_type</span>, <span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>)
    <span class="ruby-keyword">if</span>(<span class="ruby-identifier">grand2children</span>)
      <span class="ruby-identifier">res_ob_adr</span> = <span class="ruby-identifier">res_ob_adr</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/*&quot;</span>
      <span class="ruby-identifier">insert_ace</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">acc_type</span>, <span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">res_ob_type</span>, <span class="ruby-identifier">res_ob_adr</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">id</span>
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- create_ace-source -->
          
        </div>

        

        
      </div><!-- create_ace-method -->

    
      <div id="method-i-create_group" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_group</span><span
            class="method-args">(name, member_of = ["ALL"], members = [])</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Create group with name and membership in groups and members as groups or
individual</p>

<p>Note:</p>

<pre>members can be groups or individuals; 
At first method check if the name already exist. Or if groups and members exist at all

* *Args*    :
  - +name+ -&gt; name of the new group
  - +member_of+ -&gt; array of groups where new group will be member.
  - +members+ -&gt; array of principals, who will be members of new group
      members can be groups or individuals; 
      check if it the name already exist. Or if groups and members exist at all
* *Returns* :
  - string, name of the group
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="create_group-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 539</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_group</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">member_of</span> = [<span class="ruby-string">&quot;ALL&quot;</span>], <span class="ruby-identifier">members</span> = [])    
  <span class="ruby-ivar">@group</span>.<span class="ruby-identifier">create_new</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">member_of</span>, <span class="ruby-identifier">members</span>)   
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- create_group-source -->
          
        </div>

        

        
      </div><!-- create_group-method -->

    
      <div id="method-i-create_principal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_principal</span><span
            class="method-args">(name, groups = ["ALL"])</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It creates principal with name and membership in groups.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the princpal
  - +groups+ -&gt; array of groups where principal will be member.
* *Returns* :
  - string, name of the principal
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="create_principal-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 516</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_principal</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">groups</span> = [<span class="ruby-string">&quot;ALL&quot;</span>])
  <span class="ruby-ivar">@indi</span>.<span class="ruby-identifier">create_new</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">groups</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- create_principal-source -->
          
        </div>

        

        
      </div><!-- create_principal-method -->

    
      <div id="method-i-create_privilege" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_privilege</span><span
            class="method-args">(name, member_of = ["ALL_PRIVILEGES"])</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It creates privilege with name and membership in specified privileges.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the privilege
  - +member_of+ -&gt; array of privileges where new privilege will be member.
* *Returns* :
  - string, name of the privilege
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="create_privilege-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 555</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_privilege</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">member_of</span> = [<span class="ruby-string">&quot;ALL_PRIVILEGES&quot;</span>])
  <span class="ruby-ivar">@priv</span>.<span class="ruby-identifier">create_new</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">member_of</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- create_privilege-source -->
          
        </div>

        

        
      </div><!-- create_privilege-method -->

    
      <div id="method-i-create_resource_object" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_resource_object</span><span
            class="method-args">(type, address, owner)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It creates resource object with type, address and owner.</p>

<pre>* *Args*    :
  - +type+ -&gt; type of resource object. e.g. doc, room, file, collection
  - +address+ -&gt; address of the resource object. If it ends with /*, it means all children
  - +owner+ -&gt; owner of the resource object
* *Returns* :
  - string, id of the created resource object
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="create_resource_object-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 572</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_resource_object</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">owner</span>)
  <span class="ruby-comment">#puts &quot;type #{type} add #{address}&quot;</span>
  <span class="ruby-identifier">id</span> = <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">create_new</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>, <span class="ruby-identifier">owner</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">id</span>
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- create_resource_object-source -->
          
        </div>

        

        
      </div><!-- create_resource_object-method -->

    
      <div id="method-i-del_membership_principal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">del_membership_principal</span><span
            class="method-args">(prin_name, groups)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It removes principal from group(s) where principal is member.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the principal
  - +groups+ -&gt; array of groups, where principal is member.
* *Returns* :
  - string, name of the principal
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="del_membership_principal-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 706</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">del_membership_principal</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">groups</span>) <span class="ruby-comment">#deletes prin_name from group(s)</span>
  <span class="ruby-ivar">@prin</span>.<span class="ruby-identifier">del_membership</span>(<span class="ruby-identifier">prin_name</span>, <span class="ruby-identifier">groups</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- del_membership_principal-source -->
          
        </div>

        

        
      </div><!-- del_membership_principal-method -->

    
      <div id="method-i-del_membership_privilege" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">del_membership_privilege</span><span
            class="method-args">(priv_name, groups)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It removes the privilege from parental privilege(s) where the privilege is
member.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the privilege
  - +groups+ -&gt; array of groups, where privilege is member.
* *Returns* :
  - string, name of the privilege
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="del_membership_privilege-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 722</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">del_membership_privilege</span>(<span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">groups</span>) <span class="ruby-comment">#deletes prin_name from group(s)</span>
  <span class="ruby-ivar">@priv</span>.<span class="ruby-identifier">del_membership</span>(<span class="ruby-identifier">priv_name</span>, <span class="ruby-identifier">groups</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- del_membership_privilege-source -->
          
        </div>

        

        
      </div><!-- del_membership_privilege-method -->

    
      <div id="method-i-delete_ace" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_ace</span><span
            class="method-args">(ace_id)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It deletes ACE from ACL.</p>

<pre>* *Args*    :
  - +ace_id+ -&gt; id of the ACE
* *Returns* :
  -string, name of the 
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="delete_ace-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 800</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_ace</span>(<span class="ruby-identifier">ace_id</span>)
  <span class="ruby-ivar">@ace</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">ace_id</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_ace-source -->
          
        </div>

        

        
      </div><!-- delete_ace-method -->

    
      <div id="method-i-delete_principal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_principal</span><span
            class="method-args">(name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It deletes principal from ACL. It also deletes all linked ACEs.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the principal
* *Returns* :
  -string, name of the pricipal
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="delete_principal-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 737</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_principal</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-ivar">@prin</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">name</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_principal-source -->
          
        </div>

        

        
      </div><!-- delete_principal-method -->

    
      <div id="method-i-delete_privilege" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_privilege</span><span
            class="method-args">(name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It deletes privilege from ACL. It also deletes all linked ACEs.</p>

<pre>* *Args*    :
  - +name+ -&gt; name of the privilege
* *Returns* :
  -string, name of the privilege
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="delete_privilege-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 752</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_privilege</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-ivar">@priv</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">name</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_privilege-source -->
          
        </div>

        

        
      </div><!-- delete_privilege-method -->

    
      <div id="method-i-delete_res_object" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_res_object</span><span
            class="method-args">(type, address)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It deletes resource object from ACL. It also deletes all linked ACEs.</p>

<pre>* *Args*    :
  - +type+ -&gt; type of the resource object
  - +address+ -&gt; address of the resource object
* *Returns* :
  -string, name of the resource object
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="delete_res_object-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 768</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_res_object</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>)
  <span class="ruby-identifier">res_ob_id</span> = <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">find_res_ob</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">address</span>)
  <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">res_ob_id</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">res_ob_id</span>
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_res_object-source -->
          
        </div>

        

        
      </div><!-- delete_res_object-method -->

    
      <div id="method-i-delete_res_object_by_id" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_res_object_by_id</span><span
            class="method-args">(id)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It deletes resource object from ACL by id. It also deletes all linked ACEs.</p>

<pre>* *Args*    :
  - +id+ -&gt; id of the resource object
* *Returns* :
  -string, name of the resource object
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="delete_res_object_by_id-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 785</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_res_object_by_id</span>(<span class="ruby-identifier">id</span>)
  <span class="ruby-ivar">@res_obj</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">id</span>)
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_res_object_by_id-source -->
          
        </div>

        

        
      </div><!-- delete_res_object_by_id-method -->

    
      <div id="method-i-rename" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename</span><span
            class="method-args">(new_name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Renames acl (also in db)</p>

<pre>* *Args*    :
  - +new_name+ -&gt; new name of acl
* *Returns* :
  -int, handle of the query
* *Raises* :
  - +RubyACLException+ -&gt; Failed to set new name</pre>
          

          
          <div class="method-source-code" id="rename-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 286</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename</span>(<span class="ruby-identifier">new_name</span>)
  <span class="ruby-identifier">query</span> = <span class="ruby-node">&quot;update value doc(\&quot;#{@col_path}acl.xml\&quot;)/acl/@aclname with \&quot;#{new_name}\&quot;&quot;</span>
  <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">execute_query</span>(<span class="ruby-identifier">query</span>)
  <span class="ruby-identifier">query</span> = <span class="ruby-node">&quot;doc(\&quot;#{@col_path}acl.xml\&quot;)/acl/string(@aclname)&quot;</span>
  <span class="ruby-identifier">handle</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">execute_query</span>(<span class="ruby-identifier">query</span>)
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">new_name</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">retrieve</span>(<span class="ruby-identifier">handle</span>, <span class="ruby-value">0</span>))
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">RubyACLException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">__method__</span>, <span class="ruby-string">&quot;Failed to set new name&quot;</span>, <span class="ruby-value">2</span>), <span class="ruby-identifier">caller</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">XMLRPC</span><span class="ruby-operator">::</span><span class="ruby-constant">FaultException</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- rename-source -->
          
        </div>

        

        
      </div><!-- rename-method -->

    
      <div id="method-i-rename_principal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename_principal</span><span
            class="method-args">(old_name, new_name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It renames any principal. It means either individual or group.</p>

<pre>* *Args*    :
  - +old_name+ -&gt; old name of principal
  - +new_name+ -&gt;  new name of principal
* *Returns* :
  - string, original name of the principal
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="rename_principal-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 644</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_principal</span>(<span class="ruby-identifier">old_name</span>, <span class="ruby-identifier">new_name</span>)
  <span class="ruby-ivar">@prin</span>.<span class="ruby-identifier">rename</span>(<span class="ruby-identifier">old_name</span>, <span class="ruby-identifier">new_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- rename_principal-source -->
          
        </div>

        

        
      </div><!-- rename_principal-method -->

    
      <div id="method-i-rename_privilege" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename_privilege</span><span
            class="method-args">(old_name, new_name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It renames privilege.</p>

<pre>* *Args*    :
  - +old_name+ -&gt; old name of privilege
  - +new_name+ -&gt;  new name of privilege
* *Returns* :
  - string, original name of the privilege
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="rename_privilege-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 658</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_privilege</span>(<span class="ruby-identifier">old_name</span>, <span class="ruby-identifier">new_name</span>)
  <span class="ruby-ivar">@priv</span>.<span class="ruby-identifier">rename</span>(<span class="ruby-identifier">old_name</span>, <span class="ruby-identifier">new_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- rename_privilege-source -->
          
        </div>

        

        
      </div><!-- rename_privilege-method -->

    
      <div id="method-i-save" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save</span><span
            class="method-args">(path, date = false)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It saves/backs up acl</p>

<pre>* *Args*    :
  - +path+ -&gt; to local location
* *Returns* :
  - array of documents in ACL working collection
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="save-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 309</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">date</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-comment">#TODO proverit</span>
  <span class="ruby-identifier">col</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">getcollection</span>(<span class="ruby-ivar">@col_path</span>)    
  <span class="ruby-identifier">docs</span> = <span class="ruby-identifier">col</span>.<span class="ruby-identifier">docs</span>()
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">date</span>)
    <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span>(<span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span>))
    <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">docs</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">doc</span><span class="ruby-operator">|</span> 
    <span class="ruby-identifier">document</span> = <span class="ruby-identifier">col</span>[<span class="ruby-identifier">doc</span>] 
    <span class="ruby-comment">#doc = doc + &quot;_BU&quot;</span>
    <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">doc</span>
    <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-string">'w'</span>)
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">document</span>.<span class="ruby-identifier">content</span>)
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
  }
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- save-source -->
          
        </div>

        

        
      </div><!-- save-method -->

    
      <div id="method-i-show_permissions_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">show_permissions_for</span><span
            class="method-args">(prin_name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>It shows permissions for principal all its parents.</p>

<pre>* *Args*    :
  - +prin_name+ -&gt; name of the principal
* *Returns* :
  - string -&gt; all aces that has principal and all its parents.
* *Raises* :
  - +nothing+</pre>
          

          
          <div class="method-source-code" id="show_permissions_for-source">
            <pre><span class="ruby-comment"># File lib/Ruby-ACL.rb, line 442</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">show_permissions_for</span>(<span class="ruby-identifier">prin_name</span>)
  <span class="ruby-comment">#creates the set of principals {wanted principal and all groups wanted principal is member of}</span>
  <span class="ruby-identifier">prins</span> = [<span class="ruby-identifier">prin_name</span>] <span class="ruby-operator">+</span> <span class="ruby-ivar">@prin</span>.<span class="ruby-identifier">find_parents</span>(<span class="ruby-identifier">prin_name</span>)
  
  <span class="ruby-comment">#creates query, ask for principal permisions and all his parents permisions</span>
  <span class="ruby-identifier">query</span> = <span class="ruby-node">&quot;for $ace in #{@ace.doc}//Ace where (&quot;</span>    
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">prin</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">prins</span>
    <span class="ruby-identifier">query</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;($ace/Principal/@idref=\&quot;#{prin}\&quot;) or&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-4</span>]    <span class="ruby-comment">#delete last or</span>
  <span class="ruby-identifier">query</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;) return $ace&quot;</span>
  
  <span class="ruby-identifier">ace</span> = <span class="ruby-string">&quot;&quot;</span>  
  <span class="ruby-identifier">handle</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">execute_query</span>(<span class="ruby-identifier">query</span>)
  <span class="ruby-identifier">hits</span> = <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">get_hits</span>(<span class="ruby-identifier">handle</span>)
  <span class="ruby-identifier">hits</span>.<span class="ruby-identifier">times</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ace</span> = <span class="ruby-identifier">ace</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@connector</span>.<span class="ruby-identifier">retrieve</span>(<span class="ruby-identifier">handle</span>, <span class="ruby-identifier">i</span>) <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span>  <span class="ruby-comment">#retrieve and add next ACE</span>
  }
  <span class="ruby-identifier">ace</span> = <span class="ruby-identifier">ace</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]    <span class="ruby-comment">#delete last \n</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ace</span>
<span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- show_permissions_for-source -->
          
        </div>

        

        
      </div><!-- show_permissions_for-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

